<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>امتحان أنظمة التشغيل (OS)</title>
    <!-- تحميل Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* استخدام خط Inter للإنجليزية و Cairo للعربية */
        body {
            font-family: 'Inter', 'Cairo', sans-serif;
        }
        /* كلاسات مخصصة للتصحيح */
        .correct {
            background-color: #16a34a !important; /* bg-green-600 */
            color: white !important;
            border-color: #22c55e; /* border-green-500 */
            border-width: 2px;
        }
        .incorrect {
            background-color: #dc2626 !important; /* bg-red-600 */
            color: white !important;
            border-color: #ef4444; /* border-red-500 */
            border-width: 2px;
        }
        /* إخفاء العنصر */
        .hidden {
            display: none;
        }
        /* تنسيق جدول البيانات */
        #process-table th, #process-table td {
            border: 1px solid #4b5563; /* border-gray-600 */
            padding: 8px;
            text-align: center;
        }
        #process-table th {
            background-color: #374151; /* bg-gray-700 */
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 sm:p-10 w-full max-w-3xl">

        <!-- حاوية الاختبار -->
        <div id="quiz-container">
            <header class="text-center mb-6">
                <h1 class="text-3xl font-bold text-cyan-400">امتحان أنظمة التشغيل (Mid 2025 National IS )</h1>
                <p id="progress" class="text-lg text-gray-400 mt-2"></p>
            </header>

            <!-- حاوية جدول البيانات (مخفية افتراضيًا) -->
            <div id="process-table-container" class="hidden mb-6 bg-gray-900 p-4 rounded-lg shadow-inner" dir="ltr">
                <h3 class="text-lg font-semibold text-center text-cyan-400 mb-3">Process Data</h3>
                <table id="process-table" class="w-full text-sm text-white">
                    <thead>
                        <tr>
                            <th>Process</th>
                            <th>Arrival Time</th>
                            <th>Burst Time</th>
                            <th>Priority</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>P1</td>
                            <td>0</td>
                            <td>8</td>
                            <td>3</td>
                        </tr>
                        <tr>
                            <td>P2</td>
                            <td>1</td>
                            <td>4</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>P3</td>
                            <td>2</td>
                            <td>9</td>
                            <td>4</td>
                        </tr>
                        <tr>
                            <td>P4</td>
                            <td>3</td>
                            <td>5</td>
                            <td>2</td>
                        </tr>
                    </tbody>
                </table>
                <p class="text-xs text-center text-gray-400 mt-2">(Lower number = higher priority)</p>
            </div>

            <!-- منطقة السؤال -->
            <div class="bg-gray-900 p-6 rounded-lg shadow-inner min-h-[80px] flex items-center justify-center">
                <h2 id="question" class="text-2xl font-semibold text-center leading-relaxed" dir="ltr"></h2>
            </div>

            <!-- منطقة الخيارات -->
            <div id="options-container" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8">
                <!-- سيتم ملء الخيارات هنا عبر جافاسكريبت -->
            </div>

            <!-- منطقة الإفادة (صحيح/خاطئ) -->
            <div id="feedback" class="text-center text-xl font-bold mt-6 min-h-[2rem]">
                <span id="feedback-text"></span>
                <img id="feedback-image" src="" alt="Gantt Chart Explanation" class="hidden mt-4 rounded-lg mx-auto shadow-lg" style="max-width: 100%; height: auto; border: 2px solid #4b5563;"/>
            </div>

            <!-- زر التالي -->
            <button id="next-btn" class="hidden bg-cyan-600 text-white font-bold py-3 px-8 rounded-lg mt-8 w-full hover:bg-cyan-700 transition-colors duration-300 shadow-lg text-lg">
                التالي
            </button>
        </div>

        <!-- حاوية النتائج (مخفية افتراضيًا) -->
        <div id="results-container" class="hidden text-center">
            <h2 class="text-4xl font-bold text-cyan-400 mb-4">اكتمل الاختبار!</h2>
            <p id="score" class="text-3xl text-white mb-8"></p>
            <button id="restart-btn" class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-700 transition-colors duration-300 shadow-lg text-lg">
                إعادة الاختبار
            </button>
        </div>
    </div>

    <script>
        // --- 1. تعريف الأسئلة (من ملف PDF الخاص بـ OS) ---
        
        // تم نقل بيانات الجدول إلى حاوية HTML، هنا فقط الأسئلة والصور
        const allQuestions = [
            { question: "What is a semaphore?", type: 'mcq', options: ['A type of interrupt', 'A file system structure', 'A synchronization tool for controlling access to shared resources', 'A hardware device for memory management'], answer: 'A synchronization tool for controlling access to shared resources' },
            { question: "What is \"mutual exclusion\" in the context of the critical-section problem?", type: 'mcq', options: ['Allowing multiple processes to access the critical section simultaneously', 'Ensuring that only one process can execute its critical section at a time', 'Preventing processes from entering the critical section', 'Allowing processes to access any part of the memory'], answer: 'Ensuring that only one process can execute its critical section at a time' },
            { question: "What is the main purpose of having different modes (User Mode and Kernel Mode) in an operating system?", type: 'mcq', options: ['To allow multiple users to run applications simultaneously', 'To increase the speed of user applications', 'To provide security and prevent user programs from accessing critical system resources', 'To simplify the operating system design'], answer: 'To provide security and prevent user programs from accessing critical system resources' },
            // سؤال 11 - تم إضافة رابط الصورة
            { question: `Using Priority scheduling (non-preemptive), what is the waiting time for process P4?`, type: 'mcq', options: ['12', '4', '8', '9'], answer: '9', ganttImage: 'https://blogger.googleusercontent.com/img/a/AVvXsEhShv3lJ33r2yxFqwgXT6dRJY57paNDjYSntuFER6R3fr963po9DjVkewr3IKaL2kGlr7ubpe88uY2QjJIr7l6cdWndRGT9h2_iBV2GJwTfb07_qDYVuHHLA52UalBeVKfKdOCT7JjqakMTczOOgZ5ocb9t7bQHeAFLz2JvQeB2KXgpwxovtdkMZHovngY' },
            { question: "What is the purpose of an interrupt vector table?", type: 'mcq', options: ['To store the file system structure', 'To store the list of running processes', 'To store the addresses of interrupt handlers', "To store the system's memory map"], answer: 'To store the addresses of interrupt handlers' },
            { question: "What is \"bounded waiting\" in the context of the critical-section problem?", type: 'mcq', options: ['Ensuring that a process waits for a limited time to enter the critical section', 'Limiting the amount of memory used by a process', 'Limiting the number of processes that can access the critical section', 'Preventing processes from entering the critical section'], answer: 'Ensuring that a process waits for a limited time to enter the critical section' },
            { question: "What is the purpose of a process control block (PCB)?", type: 'mcq', options: ['To manage the file system', 'To store the data used by a process', 'To store the executable code of a process', 'To store information about a process, such as its state and program counter'], answer: 'To store information about a process, such as its state and program counter' },
            { question: "What event causes a process to transition from the \"Running\" state to the \"Waiting\" state?", type: 'mcq', options: ['I/O request', 'Time slice expiration', 'Process termination', 'Process creation'], answer: 'I/O request' },
            // سؤال 16 - تم إضافة رابط الصورة
            { question: `Using Round-Robin (RR) scheduling with a time quantum of 2, what is the response time for process P2?`, type: 'mcq', options: ['6', '1', '2', '0'], answer: '1', ganttImage: 'https://blogger.googleusercontent.com/img/a/AVvXsEjf5vKKufwm-8g9QJZNMZazXaTTp-59O98a8p5RQ64UwMvcsQhecVQSpWWXg3rcF-mY6DLy71jaakOc6UT_P1lySI_14wtnZHawXvyF__88LeTNvTgj2R8pNaQlrNZ3QG2_W8HrJiC0Epbcgbz_BVCJOhnH_axD0IDceJZp83E-nkwPknQ2xLsSXWMEVdI' },
            { question: "What is a system call?", type: 'mcq', options: ['A hardware interrupt', 'A call to a user-defined function', 'An interface between a user program and the operating system kernel', 'A memory allocation instruction'], answer: 'An interface between a user program and the operating system kernel' },
            { question: "Which scheduling algorithm can lead to \"starvation\" of low-priority processes?", type: 'mcq', options: ['Priority Scheduling', 'First-Come, First-Served (FCFS)', 'Preemptive scheduling', 'Round Robin (RR)'], answer: 'Priority Scheduling' },
            { question: "What is the main purpose of Direct Memory Access (DMA)?", type: 'mcq', options: ['To increase CPU processing speed', 'To manage virtual memory', 'To schedule processes', 'To allow I/O devices to directly access system memory without CPU intervention'], answer: 'To allow I/O devices to directly access system memory without CPU intervention' },
            { question: "Which of the following is an example of a system call?", type: 'mcq', options: ['Calculating the square root of a number', 'Sorting an array', 'Performing a complex mathematical computation', 'Printing text to the console'], answer: 'Printing text to the console' },
            { question: "What is the critical section?", type: 'mcq', options: ['A section of the disk used for storing system files', 'A section of code that accesses shared resources', 'A section of the kernel that handles interrupts', 'A section of memory used for storing critical data'], answer: 'A section of code that accesses shared resources' },
            { question: "What is the purpose of the \"mutex\" semaphore in a typical Bounded-Buffer solution?", type: 'mcq', options: ['To ensure mutual exclusion when accessing the buffer', 'To count the number of items in the buffer', 'To manage the consumer process', 'To manage the producer process'], answer: 'To ensure mutual exclusion when accessing the buffer' },
            { question: "What is the purpose of the \"mode bit\" in the CPU?", type: 'mcq', options: ['To handle hardware interrupts', 'To control memory allocation', 'To manage process scheduling', 'To indicate whether the CPU is in User Mode or Kernel Mode'], answer: 'To indicate whether the CPU is in User Mode or Kernel Mode' },
            { question: "Why does priority inversion occur?", type: 'mcq', options: ['Due to hardware failures', 'Due to incorrect memory allocation', 'Due to the use of shared resources and synchronization mechanisms', 'Due to inefficient CPU scheduling'], answer: 'Due to the use of shared resources and synchronization mechanisms' },
            // سؤال 25 - تم إضافة رابط الصورة
            { question: `Using First-Come, First-Served (FCFS) scheduling, what is the waiting time for process P3?`, type: 'mcq', options: ['21', '19', '12', '10'], answer: '10', ganttImage: 'https://blogger.googleusercontent.com/img/a/AVvXsEiPO5wSe-mTcuYxxLz_gPuAcb0nlnMeIZk1FeoMfEHIlCZw5xE6eSdO-9D3TdOzT2fU4EdhlEZVr2YWSUu1pDbFwj8lYB2h5RRqiNl045BABrNuLuqnhXw4rxjilUFRvGSvPF8d4HkVKzFbjO0lHw3xvMtHgU8M2Yi3E3IzHMy7Ko7I5f_TpDHdarpfFLY' },
            { question: "What is the Bounded-Buffer Problem?", type: 'mcq', options: ['A problem of scheduling CPU processes', 'A problem of managing memory allocation', 'A problem of managing disk I/O', 'A problem of coordinating producer and consumer processes sharing a fixed-size buffer'], answer: 'A problem of coordinating producer and consumer processes sharing a fixed-size buffer' },
            // سؤال 27 - تم إضافة رابط الصورة
            { question: `Using Shortest-Job-First (SJF) scheduling (non-preemptive), what is the waiting time for process P4?`, type: 'mcq', options: ['11', '6', '9', '13'], answer: '9', ganttImage: 'https://blogger.googleusercontent.com/img/a/AVvXsEgZPjF7I-UzkfZzVRjBBlah-WJjt_P4Ti_A20-eHcfxJAt5mwE1ItJot7ZpzF8ToWmjRDtzV11UEJfkGzsl5pk30scW2eavBD7iUa5UvT71-iAdEKL9fRgdg95OugBh8xkdp0kkFhvL0hducoh5OqKTFLoQ86KDLqQ58u5snEVpp75W7CzAIkIxz8rAIoQ' }
        ];

        // --- 2. الإشارة إلى عناصر الصفحة ---
        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const questionEl = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const progressEl = document.getElementById('progress');
        const feedbackTextEl = document.getElementById('feedback-text'); // تم التعديل
        const feedbackImageEl = document.getElementById('feedback-image'); // تم الإضافة
        const processTableContainer = document.getElementById('process-table-container'); // تم الإضافة
        const nextBtn = document.getElementById('next-btn');
        const scoreEl = document.getElementById('score');
        const restartBtn = document.getElementById('restart-btn');

        // --- 3. متغيرات حالة الاختبار ---
        let currentQuestionIndex = 0;
        let score = 0;
        let answerSelected = false;

        // --- 4. وظائف الاختبار ---

        /** بدء الاختبار أو إعادة تشغيله */
        function startQuiz() {
            currentQuestionIndex = 0;
            score = 0;
            answerSelected = false;
            resultsContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            loadQuestion();
        }

        /** تحميل السؤال الحالي */
        function loadQuestion() {
            answerSelected = false; 
            feedbackTextEl.textContent = ''; // تم التعديل
            feedbackImageEl.classList.add('hidden'); // تم الإضافة
            feedbackImageEl.src = ''; // تم الإضافة
            nextBtn.classList.add('hidden'); 
            optionsContainer.innerHTML = ''; 

            const currentQuestion = allQuestions[currentQuestionIndex];
            
            progressEl.textContent = `السؤال ${currentQuestionIndex + 1} من ${allQuestions.length}`;
            
            // إظهار أو إخفاء جدول البيانات
            if (currentQuestion.ganttImage) {
                processTableContainer.classList.remove('hidden');
            } else {
                processTableContainer.classList.add('hidden');
            }
            
            questionEl.textContent = currentQuestion.question;
            questionEl.dir = "ltr"; // كل الأسئلة إنجليزية
            
            // إنشاء أزرار الخيارات
            optionsContainer.className = 'grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8';
            currentQuestion.options.forEach(option => {
                const button = createOptionButton(option, option);
                optionsContainer.appendChild(button);
            });
        }

        /** إنشاء زر خيار */
        function createOptionButton(text, value) {
            const button = document.createElement('button');
            button.textContent = text;
            button.dataset.value = value; 
            button.className = "bg-gray-700 p-4 rounded-lg text-left w-full transition-all duration-200 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-white text-lg ltr:text-left rtl:text-right";
            button.dir = "ltr"; // كل الخيارات إنجليزية
            
            // جعل الخيارات الرقمية في المنتصف
            if (!isNaN(text)) {
                 button.classList.add("text-center");
            }

            button.addEventListener('click', () => selectAnswer(button));
            return button;
        }

        /** معالجة اختيار الإجابة */
        function selectAnswer(selectedButton) {
            if (answerSelected) return; 
            answerSelected = true;

            const currentQuestion = allQuestions[currentQuestionIndex];
            const selectedValue = selectedButton.dataset.value;
            const correctAnswer = currentQuestion.answer;
            
            let isCorrect = (selectedValue === correctAnswer);

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-70', 'cursor-not-allowed');
            });

            if (isCorrect) {
                score++;
                selectedButton.classList.add('correct');
                feedbackTextEl.textContent = 'إجابة صحيحة!'; // تم التعديل
                feedbackTextEl.className = 'text-center text-xl font-bold mt-6 min-h-[2rem] text-green-500'; // تم التعديل
            } else {
                selectedButton.classList.add('incorrect');
                feedbackTextEl.textContent = 'إجابة خاطئة!'; // تم التعديل
                feedbackTextEl.className = 'text-center text-xl font-bold mt-6 min-h-[2rem] text-red-500'; // تم التعديل

                const correctValue = String(correctAnswer);
                const correctButton = optionsContainer.querySelector(`button[data-value="${correctValue.replace(/"/g, '\\"')}"]`);
                if (correctButton) {
                    correctButton.classList.add('correct');
                }
            }

            // إظهار صورة الشرح (Gantt Chart) إن وجدت
            if (currentQuestion.ganttImage) {
                feedbackImageEl.src = currentQuestion.ganttImage;
                feedbackImageEl.classList.remove('hidden');
            }

            nextBtn.classList.remove('hidden');
        }

        /** الانتقال للسؤال التالي أو إظهار النتائج */
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        /** إظهار شاشة النتائج النهائية */
        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            scoreEl.textContent = `لقد حصلت على ${score} من ${allQuestions.length}`;
        }

        // --- 5. ربط الأحداث ---
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', startQuiz);

        // --- 6. بدء الاختبار عند تحميل الصفحة ---
        startQuiz();
    </script>
</body>
</html>