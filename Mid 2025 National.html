<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>امتحان أنظمة التشغيل (Mid 2025 National)</title>
    <!-- تحميل Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Cairo:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', 'Cairo', sans-serif;
        }
        .correct {
            background-color: #16a34a !important; /* bg-green-600 */
            color: white !important;
            border-color: #22c55e; /* border-green-500 */
            border-width: 2px;
        }
        .incorrect {
            background-color: #dc2626 !important; /* bg-red-600 */
            color: white !important;
            border-color: #ef4444; /* border-red-500 */
            border-width: 2px;
        }
        .hidden {
            display: none;
        }
        /* تنسيق للأسئلة التي تفتقد للبيانات */
        .missing-data-note {
            font-size: 0.9rem;
            color: #f59e0b; /* text-amber-500 */
            margin-top: 8px;
            display: block;
            font-style: italic;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="bg-gray-800 rounded-2xl shadow-2xl p-6 sm:p-10 w-full max-w-3xl">

        <!-- حاوية الاختبار -->
        <div id="quiz-container">
            <header class="text-center mb-6">
                <h1 class="text-3xl font-bold text-cyan-400">امتحان أنظمة التشغيل (Mid 2025 National)</h1>
                <p id="progress" class="text-lg text-gray-400 mt-2"></p>
            </header>

            <!-- منطقة السؤال -->
            <div class="bg-gray-900 p-6 rounded-lg shadow-inner min-h-[100px] flex items-center justify-center">
                <h2 id="question" class="text-2xl font-semibold text-center leading-relaxed" dir="ltr"></h2>
            </div>

            <!-- منطقة الخيارات -->
            <div id="options-container" class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8">
                <!-- سيتم ملء الخيارات هنا عبر جافاسكريبت -->
            </div>

            <!-- منطقة الإفادة (صحيح/خاطئ) -->
            <div id="feedback" class="text-center text-xl font-bold mt-6 min-h-[2rem]">
                <!-- سيتم عرض الإفادة هنا -->
            </div>

            <!-- زر التالي -->
            <button id="next-btn" class="hidden bg-cyan-600 text-white font-bold py-3 px-8 rounded-lg mt-8 w-full hover:bg-cyan-700 transition-colors duration-300 shadow-lg text-lg">
                التالي
            </button>
        </div>

        <!-- حاوية النتائج (مخفية افتراضيًا) -->
        <div id="results-container" class="hidden text-center">
            <h2 class="text-4xl font-bold text-cyan-400 mb-4">اكتمل الاختبار!</h2>
            <p id="score" class="text-3xl text-white mb-8"></p>
            <button id="restart-btn" class="bg-gray-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-700 transition-colors duration-300 shadow-lg text-lg">
                إعادة الاختبار
            </button>
        </div>
    </div>

    <script>
        // --- 1. تعريف الأسئلة (من ملف PDF الجديد) ---
        const allQuestions = [
            // الأسئلة المكتملة
            { question: "What is a short-term scheduler?", type: 'mcq', options: ['It selects which process must be brought into the ready queue', 'It selects which process must be executed next and allocates CPU', 'It selects which process must be removed from memory by swapping', 'None of the mentioned'], answer: 'It selects which process must be executed next and allocates CPU' },
            { question: "The primary function of the Bootstrap program is to:", type: 'mcq', options: ['Initialize the system and load the operating system', 'Manage user applications', 'Connect to the internet', 'Run games and multimedia'], answer: 'Initialize the system and load the operating system' },
            { question: "Which type of process would benefit most from a high-performance CPU?", type: 'mcq', options: ['I/O-bound process', 'CPU-bound process', 'Both equally', 'Neither'], answer: 'CPU-bound process' },
            { question: "What is the role of the interrupt vector table in handling interrupts?", type: 'mcq', options: ['Controls the speed of the CPU', 'Stores the location of all programs in memory', 'Maps interrupt types to their corresponding interrupt service routine (ISR) locations', 'Defines memory access permissions'], answer: 'Maps interrupt types to their corresponding interrupt service routine (ISR) locations' },
            { question: "Suppose that a process is in \"Blocked\" state waiting for some I/O service. When the service is completed, it goes to the", type: 'mcq', options: ['Terminated state', 'Ready state', 'Running state', 'Suspended state'], answer: 'Ready state' },
            { question: "The Bootstrap program resides in:", type: 'mcq', options: ['RAM', 'Read-Only Memory (ROM)', 'User Space', 'Hard Disk'], answer: 'Read-Only Memory (ROM)' },
            { question: "What is the main purpose of Direct Memory Access (DMA)?", type: 'mcq', options: ['To manage memory allocation for user programs', 'To transfer data between I/O devices and memory without CPU intervention', 'To provide a user interface for interacting with the system', 'To schedule processes for execution'], answer: 'To transfer data between I/O devices and memory without CPU intervention' },
            
            // سؤال 15 (تعتمد على بيانات مفقودة، الإجابة من الملف)
            { question: "For the following system of four processes with two resources (R1, R2): If the availability vector is [2 4], is the system deadlocked? <span class='missing-data-note'>(ملاحظة: بيانات الجدول مفقودة من المصدر)</span>", type: 'mcq', options: ['Yes', 'No'], answer: 'No' },

            { question: "What is a long-term scheduler?", type: 'mcq', options: ['It selects processes which must be brought into the ready queue', 'It selects processes which must be executed next and allocates CPU', 'It selects processes which must be removed from memory by swapping', 'None of the mentioned'], answer: 'It selects processes which must be brought into the ready queue' },
            { question: "Which of the following scheduling algorithms gives the minimum average waiting time?", type: 'mcq', options: ['FCFS', 'Priority', 'Round robin', 'SJF'], answer: 'SJF' },
            { question: "Round robin scheduling falls under the category of", type: 'mcq', options: ['Non-preemptive scheduling', 'Preemptive scheduling', 'All of the mentioned', 'None of the mentioned'], answer: 'Preemptive scheduling' },
            { question: "A process is in the \"Ready\" state when:", type: 'mcq', options: ['It has finished executing', 'It is currently executing', 'It is being created', 'It is ready to execute but the CPU is currently assigned to another process'], answer: 'It is ready to execute but the CPU is currently assigned to another process' },
            { question: "The longer the time slices, the more a RR scheduler gives similar results to a FIFO scheduler", type: 'tf', answer: true },

            // سؤال 21 (بيانات مفقودة، لا يوجد إجابة محددة في الملف)
            { question: "Assuming the processes is being scheduled with the SJF scheduling algorithm (non-preemptive). The waiting time for process C is: <span class='missing-data-note'>(ملاحظة: بيانات الجدول مفقودة من المصدر)</span>", type: 'mcq', options: ['4', '6', '8', 'None of the above'], answer: '4' },

            { question: "The real difficulty with SJF in short term scheduling is", type: 'mcq', options: ['it is too good an algorithm', 'knowing the length of the next CPU request', 'it is too complex to understand', 'none of the mentioned'], answer: 'knowing the length of the next CPU request' },
            { question: "DMA is used for", type: 'mcq', options: ['High speed devices', 'Low speed devices', 'Utilizing CPU cycles', 'All of the mentioned'], answer: 'High speed devices' },
            { question: "The interval from the time of submission of a process to the time of completion is termed as", type: 'mcq', options: ['turnaround time', 'response time', 'waiting time', 'throughput'], answer: 'turnaround time' },

            // سؤال 25 (بيانات مفقودة، الإجابة من الملف)
            { question: "Assume Quantum value two, given a RR scheduler, what is the response time of process B? <span class='missing-data-note'>(ملاحظة: بيانات الجدول مفقودة من المصدر)</span>", type: 'mcq', options: ['0', '1', '2', '3', 'None of the above'], answer: '1' },
            
            // سؤال 26 (بيانات مفقودة، الإجابة من الملف)
            { question: "For the following system of four processes with two resources (R1, R2): If the availability vector is [2 3], is the system deadlocked? <span class='missing-data-note'>(ملاحظة: بيانات الجدول مفقودة من المصدر)</span>", type: 'mcq', options: ['Yes', 'No'], answer: 'Yes' },

            // سؤال 27 (بيانات مفقودة، الإجابة من الملف)
            { question: "Given a FIFO scheduler, what is the average response time for the four processes? <span class='missing-data-note'>(ملاحظة: بيانات الجدول مفقودة من المصدر)</span>", type: 'mcq', options: ['4.5', '5', '6.5', '8', 'None of the above'], answer: '5' }
        ];

        // --- 2. الإشارة إلى عناصر الصفحة ---
        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const questionEl = document.getElementById('question');
        const optionsContainer = document.getElementById('options-container');
        const progressEl = document.getElementById('progress');
        const feedbackEl = document.getElementById('feedback');
        const nextBtn = document.getElementById('next-btn');
        const scoreEl = document.getElementById('score');
        const restartBtn = document.getElementById('restart-btn');

        // --- 3. متغيرات حالة الاختبار ---
        let currentQuestionIndex = 0;
        let score = 0;
        let answerSelected = false;

        // --- 4. وظائف الاختبار ---

        /** بدء الاختبار أو إعادة تشغيله */
        function startQuiz() {
            // تم إزالة خلط الأسئلة بناءً على طلبك
            // allQuestions.sort(() => Math.random() - 0.5);
            currentQuestionIndex = 0;
            score = 0;
            answerSelected = false;
            resultsContainer.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            nextBtn.classList.add('hidden');
            loadQuestion();
        }

        /** تحميل السؤال الحالي */
        function loadQuestion() {
            answerSelected = false; 
            feedbackEl.textContent = ''; 
            nextBtn.classList.add('hidden'); 
            optionsContainer.innerHTML = ''; 

            const currentQuestion = allQuestions[currentQuestionIndex];
            
            progressEl.textContent = `السؤال ${currentQuestionIndex + 1} من ${allQuestions.length}`;
            // استخدام innerHTML للسماح بعرض الـ span الخاص بالملاحظات
            questionEl.innerHTML = currentQuestion.question; 
            questionEl.dir = "ltr";
            
            // إنشاء أزرار الخيارات
            if (currentQuestion.type === 'mcq') {
                const optionsCount = currentQuestion.options.length;
                // تعديل التنسيق إذا كان عدد الخيارات 2 (مثل Yes/No)
                if (optionsCount === 2) {
                    optionsContainer.className = 'grid grid-cols-2 gap-4 mt-8';
                } else {
                    optionsContainer.className = 'grid grid-cols-1 sm:grid-cols-2 gap-4 mt-8';
                }
                
                currentQuestion.options.forEach(option => {
                    const button = createOptionButton(option, option);
                    optionsContainer.appendChild(button);
                });
            } else if (currentQuestion.type === 'tf') {
                optionsContainer.className = 'grid grid-cols-2 gap-4 mt-8';
                const trueButton = createOptionButton('True', true);
                const falseButton = createOptionButton('False', false);
                optionsContainer.appendChild(trueButton);
                optionsContainer.appendChild(falseButton);
            }
        }

        /** إنشاء زر خيار */
        function createOptionButton(text, value) {
            const button = document.createElement('button');
            button.textContent = text;
            button.dataset.value = value; 
            button.className = "bg-gray-700 p-4 rounded-lg text-left w-full transition-all duration-200 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-cyan-500 text-white text-lg ltr:text-left rtl:text-right";
            button.dir = "ltr"; 
            if (text === 'True' || text === 'False' || text === 'Yes' || text === 'No' || !isNaN(text)) {
                 button.classList.add("text-center");
            }

            button.addEventListener('click', () => selectAnswer(button));
            return button;
        }

        /** معالجة اختيار الإجابة */
        function selectAnswer(selectedButton) {
            if (answerSelected) return; 
            answerSelected = true;

            const currentQuestion = allQuestions[currentQuestionIndex];
            const selectedValue = selectedButton.dataset.value;
            
            const correctAnswer = currentQuestion.answer;
            let isCorrect;

            if (currentQuestion.type === 'tf') {
                isCorrect = (selectedValue === String(correctAnswer));
            } else {
                isCorrect = (selectedValue === correctAnswer);
            }

            Array.from(optionsContainer.children).forEach(btn => {
                btn.disabled = true;
                btn.classList.add('opacity-70', 'cursor-not-allowed');
            });

            if (isCorrect) {
                score++;
                selectedButton.classList.add('correct');
                feedbackEl.textContent = 'إجابة صحيحة!';
                feedbackEl.className = 'text-center text-xl font-bold mt-6 min-h-[2rem] text-green-500';
            } else {
                selectedButton.classList.add('incorrect');
                feedbackEl.textContent = 'إجابة خاطئة!';
                feedbackEl.className = 'text-center text-xl font-bold mt-6 min-h-[2rem] text-red-500';

                const correctValue = String(correctAnswer);
                const correctButton = optionsContainer.querySelector(`button[data-value="${correctValue.replace(/"/g, '\\"')}"]`);
                if (correctButton) {
                    correctButton.classList.add('correct');
                }
            }

            nextBtn.classList.remove('hidden');
        }

        /** الانتقال للسؤال التالي أو إظهار النتائج */
        function nextQuestion() {
            currentQuestionIndex++;
            if (currentQuestionIndex < allQuestions.length) {
                loadQuestion();
            } else {
                showResults();
            }
        }

        /** إظهار شاشة النتائج النهائية */
        function showResults() {
            quizContainer.classList.add('hidden');
            resultsContainer.classList.remove('hidden');
            scoreEl.textContent = `لقد حصلت على ${score} من ${allQuestions.length}`;
        }

        // --- 5. ربط الأحداث ---
        nextBtn.addEventListener('click', nextQuestion);
        restartBtn.addEventListener('click', startQuiz);

        // --- 6. بدء الاختبار عند تحميل الصفحة ---
        startQuiz();
    </script>
</body>

</html>
